<?xml version="1.0"?>
  <database name="VIEW VENTAS_ANTIC_V">
    <view name="VENTAS_ANTIC_V"><![CDATA[SELECT get_uuid() AS ventas_antic_v_id, c.ad_client_id, c.ad_org_id, c.isactive, c.created, c.createdby, c.updated, c.updatedby, c.c_order_id, c.c_invoice_id, ventas_monto_anticipo(c.monto, c.c_invoice_id, c.c_order_id) AS monto FROM (SELECT COALESCE(a.c_order_id, b.c_order_id) AS c_order_id, COALESCE(a.monto, b.monto) AS monto, COALESCE(a.c_invoice_id, b.c_invoice_id) AS c_invoice_id, COALESCE(a.ad_client_id, b.ad_client_id) AS ad_client_id, COALESCE(a.ad_org_id, b.ad_org_id) AS ad_org_id, COALESCE(a.isactive, b.isactive) AS isactive, COALESCE(a.created, b.created) AS created, COALESCE(a.createdby, b.createdby) AS createdby, COALESCE(a.updated, b.updated) AS updated, COALESCE(a.updatedby, b.updatedby) AS updatedby FROM (SELECT o.c_order_id, COALESCE(i.grandtotal, 0.00) AS monto, i.c_invoice_id, o.ad_client_id, o.ad_org_id, o.isactive, o.created, o.createdby, o.updated, o.updatedby FROM c_order o LEFT JOIN c_invoice i ON o.c_order_id = i.em_ventas_ordanticipo_id AND (o.docstatus IN ('CO', 'CL')) AND i.docstatus = 'CO') a FULL JOIN (SELECT o2.c_order_id, COALESCE(il2.linenetamt * (1 + t.rate / 100), 0.00) AS monto, i2.c_invoice_id, o2.ad_client_id, o2.ad_org_id, o2.isactive, o2.created, o2.createdby, o2.updated, o2.updatedby FROM c_order o2 JOIN c_invoice i2 ON o2.c_order_id = i2.c_order_id AND NOT (i2.c_invoice_id IN (SELECT ir.c_invoice_id FROM c_invoice_reverse ir)) AND (o2.docstatus IN ('CO', 'CL')) AND i2.docstatus = 'CO' JOIN c_invoiceline il2 ON il2.c_invoice_id = i2.c_invoice_id JOIN m_product p ON il2.m_product_id = p.m_product_id AND p.em_ventas_isantic = 'Y' JOIN c_tax t ON t.c_tax_id = il2.c_tax_id) b ON 1 = 2) c ORDER BY c.monto DESC]]></view>
  </database>
